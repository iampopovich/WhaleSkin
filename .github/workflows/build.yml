name: Build All Platforms

on:
  workflow_dispatch:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  # –≠—Ç–æ—Ç –≤–æ—Ä–∫—Ñ–ª–æ—É –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç —Å–±–æ—Ä–∫—É –≤—Å–µ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º
  # –î–ª—è –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å–±–æ—Ä–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–æ—Ä–∫—Ñ–ª–æ—É:
  # - build-android.yml
  # - build-windows.yml  
  # - build-linux.yml
  # - build-web.yml
  
  info:
    name: Build Information
    runs-on: ubuntu-latest
    steps:
      - name: Print build info
        run: |
          echo "üöÄ Building WhaleSkin for all platforms"
          echo "üì± Android APK and AAB will be built"
          echo "üñ•Ô∏è Windows x64 desktop app will be built"
          echo "üêß Linux x64 desktop app will be built"
          echo "üåê Web application will be built"
          echo ""
          echo "Use individual workflow files for platform-specific builds:"
          echo "- .github/workflows/build-android.yml"
          echo "- .github/workflows/build-windows.yml"
          echo "- .github/workflows/build-linux.yml"
          echo "- .github/workflows/build-web.yml"

  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ –ø–µ—Ä–µ–¥ —Å–±–æ—Ä–∫–æ–π
  analyze:
    name: Analyze Code
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Flutter
        uses: subosito/flutter-action@v2
        with:
          channel: 'stable'
          cache: true

      - name: Get dependencies
        run: flutter pub get

      - name: Generate code
        run: flutter packages pub run build_runner build --delete-conflicting-outputs

      - name: Analyze code
        run: flutter analyze

      - name: Check formatting
        run: dart format --set-exit-if-changed lib/
